/*
---
description: siteSlider - MooTools plugin for sliding page

license: MIT-style

authors:
- Rafa≈Ç Ronowicz

requires:
- MooTools 1.3 core or higher (tested with 1.4.5)

provides: siteSlider

...
*/
var SiteSlider=new Class({Implements:[Options,Events],options:{frames:".frame",startFrame:0,navs:["ContSlidePrev","ContSlideNext"],menu:".link",transition:Fx.Transitions.Linear,duration:700,menuNav:false,menuNavName:"",onBeginning:function(){},onEnding:function(){}},initialize:function(e){this.setOptions(e);this.setFrameSize();this.Slider=(new Element("div",{id:"Slider",styles:{width:"100%",height:"100%",overflow:"hidden"}})).inject(document.body);this.FrameContainer=(new Element("div",{id:"FrameContainer",styles:{width:$$(this.options.frames).length*this.setFrameSize()}})).inject(this.Slider).adopt($$(this.options.frames));$$(this.options.frames).each(function(e){e.setStyle("overflow-y","hidden")});if(this.options.navs[0]=="ContSlidePrev"){this.slidePrev=(new Element("div",{id:"ContSlidePrev",styles:{position:"absolute",top:"0",left:"0",height:"100%",width:"50px","background-color":"lime"}})).inject(document.body);this.slideNext=(new Element("div",{id:"ContSlideNext",styles:{position:"absolute",top:"0",right:"0",height:"100%",width:"50px","background-color":"lime"}})).inject(document.body)}else{this.slidePrev=$(this.options.navs[0]);this.slideNext=$(this.options.navs[1])}this.onMove=0;this.current=this.options.startFrame;if(this.options.menuNav){$(this.options.menuNavName).getElements("li").each(function(e,t){that=this;e.addEvent("click",function(){that.goToFrame(t)},this)},this)}this.myFx=new Fx.Tween(this.FrameContainer,{property:"margin-left",duration:this.options.duration,transition:this.options.transition,link:"ignore",onStart:function(){this.onMove=1;console.log(this.current);this.showScrollbar(false)}.bind(this),onComplete:function(){this.onMove=0;console.log(this.current);this.showScrollbar(true)}.bind(this)});this.slidePrev.addEvent("click",this.showPrev.bind(this));this.slideNext.addEvent("click",this.showNext.bind(this));$$(this.options.menu)[0].addClass("active");window.onresize=this.updateFrameContainer.bind(this)},setFrameSize:function(){var e=window.getSize();$$(this.options.frames).each(function(t){this.setOverflow(t);t.setStyles({width:e.x,height:e.y})},this);return e.x},showPrev:function(e){if(this.current!=0){this.goToFrame(this.current-1)}else{return}},showNext:function(e){if(this.current!=$$(this.options.frames).length-1){this.goToFrame(this.current+1)}else{return}},getCurrPos:function(){return this.FrameContainer.getStyle("margin-left")},jumpToFrame:function(e){this.setFrameSize();this.FrameContainer.setStyle("margin-left",-(e*this.setFrameSize()));this.current=e},goToFrame:function(e){if(this.onMove==1){return}else{if(e<this.options.startFrame){var t=this.options.startFrame-e;this.myFx.start(this.getCurrPos(),parseInt(this.getCurrPos())+t*parseInt(this.setFrameSize()));this.options.startFrame=e;this.current=e}else if(this.options.startFrame<e){var t=e-this.options.startFrame;this.myFx.start(this.getCurrPos(),parseInt(this.getCurrPos())-t*parseInt(this.setFrameSize()));this.options.startFrame=e;this.current=e}else return}},setOverflow:function(e){if(window.getSize()["y"]<e.getSize()["y"])e.setStyle("overflow-y","scroll")},showScrollbar:function(e){if(e){$$(this.options.frames)[this.current].setStyle("overflow-y","auto")}else{$$(this.options.frames)[this.current].setStyle("overflow-y","hidden")}},updateFrameContainer:function(){this.jumpToFrame(this.options.startFrame);$$(this.options.frames).each(function(e){this.setOverflow(e)},this);this.FrameContainer.setStyles({width:$$(this.options.frames).length*this.setFrameSize()})}})